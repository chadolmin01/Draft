# Stage 3 통합 테스트 가이드

## 테스트 목적
Stage 1 (아이디어 해체분석)과 Stage 2 (시장 분석)의 결과를 통합하여 완전한 사업계획서(Business Report)를 생성하고 표시하는 기능을 검증합니다.

---

## 사전 준비

### 1. 개발 서버 확인
현재 개발 서버가 실행 중입니다:
- **URL**: http://localhost:3000
- **상태**: ✅ 실행 중

### 2. 환경 변수 확인
- `.env.local` 파일에 `GOOGLE_API_KEY`가 설정되어 있는지 확인하세요.

```bash
cd c:\project\Startup\frontend
cat .env.local  # 또는 notepad .env.local
```

---

## 테스트 시나리오

### 시나리오 1: 완전한 플로우 테스트 (권장)

#### 1단계: 새 아이디어 생성 (Stage 1)

1. 브라우저에서 http://localhost:3000 접속
2. 아이디어 입력:
   ```
   예시: AI를 활용한 맞춤형 식단 관리 서비스
   ```
3. Tier 선택: **Pro** (Stage 2 메인 분석과 리포트 생성을 위해)
4. "분석 시작" 버튼 클릭
5. Stage 1 결과 확인:
   - ✅ 타겟 고객
   - ✅ 문제 정의
   - ✅ 솔루션
   - ✅ 수익 분석 (Pro 티어)

#### 2단계: Stage 2 메인 분석 실행

1. Stage 1 결과 페이지에서 "시장 분석 시작하기" 버튼 클릭
2. 약 15초 대기
3. Stage 2 결과 확인:
   - ✅ 시장 규모
   - ✅ 성장률
   - ✅ 경쟁사 분석
   - ✅ 실현 가능성 점수
   - ✅ 주요 위험 요소

#### 3단계 (선택): Stage 2 심화 분석 실행

심화 분석은 선택사항이지만, 더 풍부한 리포트를 위해 1-2개 실행을 권장합니다:

1. **시장 심화 분석** 카드에서 "시장 심화 분석 생성하기" 클릭
   - TAM/SAM/SOM 상세 분석
   - 경쟁 포지셔닝 맵
   - 가격 벤치마킹

2. **전략 & 실행** 카드에서 "전략 & 실행 생성하기" 클릭
   - SWOT 분석
   - 시장 진입 전략
   - 필요 자원 추정

3. **외부 환경** 카드에서 "외부 환경 생성하기" 클릭
   - 규제 이슈
   - 투자 트렌드
   - 유사 사례 분석

#### 4단계: 통합 리포트 생성 (Stage 3 핵심 테스트)

1. 페이지 하단의 **"상세 리포트 생성하기 →"** 버튼 클릭
2. 로딩 상태 확인:
   - ✅ "리포트 생성 중... (약 20-30초)" 메시지 표시
   - ✅ 스피너 애니메이션
3. 약 20-30초 대기 (Gemini API 호출 시간)

#### 5단계: 리포트 페이지 확인

리포트 페이지가 로드되면 다음 요소들을 확인하세요:

##### 헤더
- ✅ 리포트 제목 표시
- ✅ Tier 표시 (Pro)
- ✅ "PDF 다운로드" 버튼 (클릭 시 alert)
- ✅ "실행 액션 →" 버튼

##### 사이드바 목차 (좌측, 큰 화면에서만 표시)
- ✅ 📋 사업 개요
- ✅ 📊 시장 분석
- ✅ 🏢 경쟁사 분석
- ✅ 💰 수익화 모델
- ✅ 🏗️ 사업 구조
- ✅ 💻 개발 가이드

##### 컨텐츠 섹션 (각 섹션 내용 확인)

1. **사업 개요**
   - ✅ 제목 및 태그라인
   - ✅ 사업 설명
   - ✅ Vision & Mission 카드

2. **시장 분석**
   - ✅ TAM/SAM/SOM 카드 (3개)
   - ✅ 주요 트렌드 리스트
   - ✅ 기회/위협 (Opportunities/Threats)

3. **경쟁사 분석**
   - ✅ 직접 경쟁사 카드들
   - ✅ 각 경쟁사의 강점/약점
   - ✅ "우리의 경쟁 우위" 섹션

4. **수익화 모델**
   - ✅ 수익원 (Revenue Streams)
   - ✅ 가격 정책 (Pricing Tiers)
   - ✅ 매출 예측 (3년)

5. **사업 구조**
   - ✅ 핵심 팀 구성
   - ✅ MVP 기능 정의 (must-have/should-have)

6. **Footer 액션**
   - ✅ "이제 실행할 차례입니다" 메시지
   - ✅ "액션 플랜 시작하기 →" 버튼

#### 6단계: 인터랙션 테스트

1. **사이드바 네비게이션**
   - 각 섹션 링크를 클릭하여 해당 섹션으로 스크롤되는지 확인
   - 활성화된 섹션이 하이라이트되는지 확인

2. **PDF 다운로드 버튼**
   - 클릭 시 "PDF 다운로드 기능은 백엔드 연동 후 제공됩니다" alert 표시 확인

3. **실행 액션 버튼**
   - 클릭 시 `/ideas/[id]/actions` 페이지로 이동하는지 확인

---

### 시나리오 2: 기존 데이터로 빠른 테스트

이미 Stage 1, 2를 완료한 아이디어가 있다면:

1. http://localhost:3000/ideas/[아이디어ID] 접속
2. "상세 리포트 생성하기" 버튼 클릭
3. 위의 5-6단계 진행

---

### 시나리오 3: Mock 데이터로 UI 테스트

실제 API 호출 없이 UI만 테스트하려면:

1. 브라우저 개발자 도구 (F12) 열기
2. Console에서 localStorage 비우기:
   ```javascript
   localStorage.clear();
   ```
3. http://localhost:3000/ideas/demo-pro/report 접속
4. Mock 리포트 데이터로 UI가 렌더링되는지 확인

---

## 테스트 체크리스트

### 기능 테스트
- [ ] Stage 1 → Stage 2 → Stage 3 전체 플로우 정상 동작
- [ ] 리포트 생성 버튼 클릭 시 API 호출
- [ ] localStorage에 리포트 데이터 저장 확인
- [ ] 리포트 페이지로 리다이렉트
- [ ] 모든 섹션 데이터 올바르게 표시

### UI/UX 테스트
- [ ] 헤더 고정 (sticky) 동작
- [ ] 사이드바 목차 네비게이션
- [ ] 활성 섹션 하이라이트
- [ ] 스크롤 애니메이션 부드러움
- [ ] 반응형 디자인 (모바일/태블릿/데스크톱)
- [ ] 노션 스타일 디자인 일관성

### 에러 핸들링
- [ ] Stage 1 데이터 없이 리포트 생성 시도 시 에러 처리
- [ ] API 호출 실패 시 에러 메시지 표시
- [ ] 잘못된 아이디어 ID로 접근 시 처리

### 성능 테스트
- [ ] 리포트 생성 시간 (목표: 20-30초)
- [ ] 페이지 로드 시간 (목표: 2초 이하)
- [ ] 큰 데이터셋에서도 부드러운 스크롤

---

## 예상 결과

### 성공 케이스
1. **API 호출 성공**
   - HTTP 200 응답
   - BusinessReport 타입의 JSON 데이터 반환
   - localStorage에 저장됨

2. **리포트 페이지**
   - 모든 섹션이 구조화되어 표시
   - 노션 스타일의 깔끔한 디자인
   - 사이드바 네비게이션 작동

### 실패 케이스 (예상 시나리오)
1. **GOOGLE_API_KEY 미설정**
   - 에러: "GENERATION_FAILED"
   - 해결: .env.local에 API 키 추가

2. **Stage 1 데이터 없음**
   - 에러: "INVALID_INPUT"
   - 해결: Stage 1 분석 먼저 완료

3. **API 호출 타임아웃**
   - 에러: Network timeout
   - 해결: 네트워크 연결 확인 또는 재시도

---

## 디버깅 팁

### 1. localStorage 확인
브라우저 개발자 도구 → Application → Local Storage에서 확인:
- `idea_[id]`: Stage 1 데이터
- `idea_[id]_stage2`: Stage 2 메인 분석
- `idea_[id]_deep_market-deep`: 시장 심화 분석
- `idea_[id]_deep_strategy`: 전략 분석
- `idea_[id]_deep_external`: 외부 환경 분석
- `idea_[id]_report`: **Stage 3 리포트 데이터**

### 2. 네트워크 요청 확인
개발자 도구 → Network 탭:
- `POST /api/ideas/[id]/report`
- Response 확인 (success: true, data: {...})

### 3. 콘솔 로그 확인
개발자 도구 → Console:
- 에러 메시지
- API 응답 데이터

### 4. 서버 로그 확인
터미널에서 Next.js 개발 서버 로그 확인:
```
POST /api/ideas/[id]/report 200 in 25s
```

---

## 알려진 이슈 및 제한사항

1. **PDF 다운로드**
   - 현재는 alert만 표시
   - 실제 PDF 생성은 추후 구현 예정

2. **리포트 재생성**
   - 동일한 아이디어로 리포트 재생성 시 덮어씀
   - 버전 관리 없음

3. **오프라인 모드**
   - 리포트 생성에는 인터넷 연결 필요
   - 이미 생성된 리포트는 localStorage에서 로드 가능

---

## 테스트 완료 후

### 성공 시
- [x] Stage 3 통합 리포트 기능 정상 작동
- [x] 모든 UI 컴포넌트 올바르게 렌더링
- [x] 사용자 경험 만족스러움

### 다음 단계
1. **Stage 4: 실행 액션** 구현
   - 랜딩 페이지 생성
   - 비즈니스 플랜 문서
   - 피치덱
   - MVP 가이드

2. **리포트 개선**
   - PDF 다운로드 기능 추가
   - 차트/그래프 시각화
   - 공유 기능

---

## 문제 발생 시 연락처

- 개발자 도구 콘솔의 에러 메시지 캡처
- 네트워크 요청/응답 캡처
- 재현 단계 기록

위 정보와 함께 이슈 리포트 작성

---

## 테스트 환경 정보

- **OS**: Windows 10
- **브라우저**: Chrome/Edge (권장)
- **Node.js**: v18+ 권장
- **Next.js**: 16.1.6 (Turbopack)
- **API**: Gemini 2.5 Flash
- **개발 서버**: http://localhost:3000

---

## 마무리

이 테스트를 통해 다음을 검증합니다:
1. ✅ Stage 1, 2 데이터 통합
2. ✅ Gemini API 호출 및 JSON 파싱
3. ✅ BusinessReport 타입 생성
4. ✅ localStorage 저장 및 로드
5. ✅ 노션 스타일 리포트 UI
6. ✅ 인터랙티브 네비게이션
7. ✅ 전체 사용자 여정 (Idea → Analysis → Report)

**테스트 완료 후 이 문서에 결과를 기록하세요!**
